{% extends 'panel/base_page/base.html' %}

{% load static %}

{% block title %}Appointment History{% endblock %}

{% block content %}
<div class="container mx-auto p-6 mt-10 bg-white rounded-lg shadow-md animate__animated animate__fadeInUp">
    <h1 class="text-2xl font-bold mb-4">Appointment History</h1>
    
    <table class="min-w-full border-collapse bg-gray-100">
        <thead class="bg-blue-600 text-white">
            <tr>
                <th class="py-2 px-4 border">Appointment Date</th>
                <th class="py-2 px-4 border">Time</th>
                <th class="py-2 px-4 border">Office</th>
                <th class="py-2 px-4 border">Status</th>
                <th class="py-2 px-4 border">Card Status</th>
                <th class="py-2 px-4 border">Paid</th>
                <th class="py-2 px-4 border">Receipt</th>
            </tr>
        </thead>
        <tbody>
            {% for appointment in appointments %}
                <tr class="hover:bg-gray-50">
                    <td class="py-2 px-4 border">{{ appointment.date }}</td>
                    <td class="py-2 px-4 border">{{ appointment.time }}</td>
                    <td class="py-2 px-4 border">{{ appointment.office.name }}</td>
                    <td class="py-2 px-4 border">{{ appointment.get_status_display }}</td>
                    <td class="py-2 px-4 border">{{ appointment.get_card_status_display }}</td>
                    <td class="py-2 px-4 border">{{ appointment.paid|yesno:"Yes,No" }}</td>
                    <td class="py-2 px-4 border">
                        {% if appointment.paid %}
                            <form action="{% url 'download_receipt' appointment.id %}" method="post" class="inline">
                                {% csrf_token %}
                                <button type="submit" class="bg-green-600 text-white py-1 px-3 rounded hover:bg-green-700 transition">View Receipt</button>
                            </form>
                        {% else %}
                            <span class="text-gray-500">Not Available</span>
                        {% endif %}
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}

{% block scripts %}
    <script>
        // You can add any JavaScript functionality here if necessary for further interactivity.
    </script>
{% endblock %}